#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Time : 2018/9/22 22:28
# @Author : leifengchuan
# @File : getDatasFromTushare

"""
从tushare获取数据，然后保存再自己本地mysql数据库中
"""

#!/usr/bin/python3
# -*- coding:utf-8 -*- 
'''
created by leifengchuan
'''
# coding=UTF-8
import pymysql
pymysql.install_as_MySQLdb()#备注这个是必须的
import tushare as ts
from sqlalchemy import create_engine

engine = create_engine('mysql://root:root@localhost/stockAI?charset=utf8')


def SaveDate():
    """
    定义一个方法从tushare的bar接口获取历史数据，然后保存在mysql中
    :return:
    """
    cons = ts.get_apis()
    String = "600004, 600006, 600017, 600022, 600026, 600037, 600039, 600053, 600056, 600058, 600059, 600060, 600062, 600064, 600073, 600079, 600086, 600094, 600098, 600108, 600120, 600122, 600125, 600126, 600138, 600141, 600143, 600151, 600155, 600158, 600160, 600161, 600166, 600169, 600171, 600176, 600179, 600183, 600184, 600187, 600195, 600201, 600216, 600240, 600256, 600259, 600260, 600266, 600267, 600270, 600277, 600280, 600282, 600284, 600289, 600291, 600292, 600298, 600300, 600307, 600312, 600315, 600316, 600317, 600325, 600329, 600335, 600338, 600346, 600348, 600366, 600380, 600388, 600392, 600393, 600395, 600409, 600410, 600416, 600418, 600422, 600426, 600428, 600435, 600438, 600458, 600460, 600466, 600478, 600481, 600499, 600500, 600503, 600511, 600516, 600517, 600521, 600525, 600536, 600545, 600557, 600563, 600565, 600566, 600572, 600575, 600578, 600580, 600582, 600584, 600587, 600594, 600597, 600598, 600600, 600611, 600614, 600618, 600623, 600628, 600633, 600635, 600639, 600640, 600642, 600643, 600645, 600648, 600651, 600655, 600657, 600673, 600687, 600694, 600717, 600718, 600729, 600737, 600743, 600748, 600750, 600751, 600754, 600755, 600757, 600759, 600765, 600770, 600773, 600776, 600787, 600801, 600808, 600811, 600823, 600826, 600835, 600839, 600848, 600859, 600862, 600863, 600869, 600872, 600874, 600875, 600879, 600880, 600881, 600884, 600885, 600894, 600908, 600917, 600936, 600939, 600967, 600970, 600971, 600978, 600993, 600996, 601000, 601001, 601002, 601016, 601020, 601127, 601128, 601168, 601200, 601231, 601233, 601311, 601678, 601689, 601699, 601717, 601777, 601811, 601880, 601928, 601969, 603000, 603001, 603019, 603025, 603077, 603169, 603188, 603198, 603225, 603228, 603328, 603355, 603369, 603377, 603444, 603515, 603528, 603556, 603568, 603569, 603589, 603658, 603766, 603806, 603816, 603868, 603877, 603883, 603888, 000006, 000009, 000012, 000021, 000025, 000027, 000028, 000031, 000039, 000049, 000050, 000061, 000062, 000066, 000078, 000089, 000090, 000099, 000156, 000158, 000400, 000401, 000418, 000426, 000488, 000501, 000513, 000519, 000528, 000536, 000541, 000543, 000547, 000552, 000563, 000566, 000572, 000581, 000587, 000592, 000596, 000598, 000600, 000612, 000636, 000652, 000656, 000661, 000662, 000667, 000669, 000680, 000681, 000685, 000690, 000703, 000712, 000718, 000727, 000729, 000732, 000758, 000761, 000762, 000766, 000777, 000778, 000786, 000806, 000807, 000816, 000825, 000829, 000830, 000848, 000860, 000877, 000878, 000887, 000897, 000926, 000930, 000937, 000939, 000960, 000969, 000970, 000975, 000977, 000979, 000981, 000987, 000988, 000990, 000997, 000998, 000999, 001696, 002001, 002002, 002004, 002005, 002011, 002013, 002018, 002019, 002022, 002028, 002030, 002032, 002038, 002041, 002048, 002049, 002050, 002051, 002056, 002063, 002064, 002073, 002078, 002092, 002093, 002106, 002118, 002122, 002123, 002127, 002128, 002131, 002147, 002152, 002155, 002176, 002179, 002183, 002190, 002191, 002195, 002221, 002223, 002233, 002242, 002244, 002249, 002250, 002251, 002254, 002261, 002266, 002268, 002269, 002271, 002273, 002276, 002277, 002280, 002281, 002285, 002299, 002308, 002311, 002317, 002325, 002332, 002340, 002342, 002344, 002345, 002353, 002354, 002358, 002359, 002366, 002368, 002371, 002373, 002375, 002384, 002390, 002392, 002400, 002405, 002407, 002408, 002410, 002414, 002416, 002422, 002428, 002431, 002434, 002437, 002439, 002440, 002444, 002463, 002477, 002479, 002482, 002489, 002491, 002503, 002505, 002506, 002512, 002517, 002544, 002551, 002573, 002583, 002588, 002589, 002603, 002635, 002640, 002642, 002657, 002663, 002665, 002670, 002672, 002681, 002690, 002699, 002701, 002707, 002709, 002745, 002807, 002815, 002818, 300001, 300002, 300010, 300026, 300032, 300039, 300043, 300055, 300058, 300088, 300113, 300115, 300116, 300133, 300134, 300146, 300147, 300159, 300166, 300182, 300197, 300199, 300202, 300244, 300253, 300257, 300266, 300273, 300274, 300287, 300291, 600000, 600008, 600009, 600010, 600011, 600015, 600016, 600018, 600019, 600021, 600023, 600028, 600029, 600030, 600031, 600036, 600038, 600048, 600050, 600061, 600066, 600068, 600074, 600085, 600089, 600100, 600104, 600109, 600111, 600115, 600118, 600153, 600157, 600170, 600177, 600188, 600196, 600208, 600219, 600221, 600233, 600271, 600276, 600297, 600309, 600332, 600340, 600352, 600362, 600369, 600372, 600373, 600376, 600383, 600390, 600406, 600415, 600436, 600482, 600485, 600489, 600498, 600518, 600519, 600522, 600535, 600547, 600549, 600570, 600583, 600585, 600588, 600606, 600637, 600649, 600660, 600663, 600674, 600682, 600685, 600688, 600690, 600703, 600704, 600705, 600739, 600741, 600795, 600804, 600816, 600820, 600827, 600837, 600871, 600886, 600887, 600893, 600895, 600900, 600909, 600919, 600926, 600958, 600959, 600977, 600999, 601006, 601009, 601012, 601018, 601021, 601088, 601099, 601111, 601117, 601118, 601155, 601163, 601166, 601169, 601186, 601198, 601211, 601212, 601216, 601225, 601228, 601229, 601288, 601318, 601328, 601333, 601336, 601375, 601377, 601390, 601398, 601555, 601600, 601601, 601607, 601608, 601611, 601618, 601628, 601633, 601668, 601669, 601688, 601718, 601727, 601766, 601788, 601800, 601818, 601857, 601866, 601872, 601877, 601878, 601881, 601888, 601898, 601899, 601901, 601919, 601933, 601939, 601958, 601966, 601985, 601988, 601989, 601991, 601992, 601997, 601998, 603160, 603799, 603833, 603858, 603993, 000001, 000002, 000008, 000060, 000063, 000069, 000100, 000157, 000166, 000333, 000338, 000402, 000413, 000415, 000423, 000425, 000503, 000538, 000540, 000559, 000568, 000623, 000625, 000627, 000630, 000651, 000671, 000686, 000709, 000723, 000725, 000728, 000738, 000750, 000768, 000776, 000783, 000792, 000826, 000839, 000858, 000876, 000895, 000898, 000938, 000959, 000961, 000963, 000983, 001979, 002007, 002008, 002024, 002027, 002044, 002065, 002074, 002081, 002142, 002146, 002153, 002174, 002202, 002230, 002236, 002241, 002252, 002292, 002294, 002304, 002310, 002352, 002385, 002411, 002415, 002424, 002426, 002450, 002456, 002460, 002465, 002466, 002468, 002470, 002475, 002500, 002508, 002555, 002558, 002572, 002594, 002601, 002602, 002608, 002624, 002673, 002714, 002736, 002739, 002797, 002831, 002839, 002841, 300003, 300015, 300017, 300024, 300027, 300033, 300059, 300070, 300072, 300122, 300124, 300136, 300144, 300251, 300315"
    list = String.split(", ")
    for i in range(len(list)):
        # i=str(list[i]).strip(" ")
        print("begin save code is {}条,===={}".format(i, list[i]))
        df = ts.bar(list[i], conn=cons, freq='D', start_date='2004-01-05', end_date='', ma=[5, 10, 20],factors=['vr', 'tor'])
        # df.to_excel('d:/test/'+list[i]+'.xlsx')
        df.to_sql('tick_data_vol', engine, if_exists='append')
    ts.close_apis(cons)


'''
test
'''
if __name__ == "__main__":
    SaveDate()
